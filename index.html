<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì‚¬ë‹¤ë¦¬íƒ€ê¸° (6ëª…/1ëª… ë‹¹ì²¨)</title>

  <!-- âœ… ì¹´ì¹´ì˜¤í†¡ ê³µìœ /ë¯¸ë¦¬ë³´ê¸°ìš©(Open Graph) -->
  <!-- ë°°í¬ í›„ ì•„ë˜ 3ê°€ì§€ëŠ” ë°˜ë“œì‹œ 'ë‚´ê°€ ë°°í¬í•œ ì£¼ì†Œ'ë¡œ ë°”ê¿”ì£¼ì„¸ìš”. -->
  <meta property="og:title" content="ì‚¬ë‹¤ë¦¬íƒ€ê¸° (6ëª…/1ëª… ë‹¹ì²¨)" />
  <meta property="og:description" content="ì¹´í†¡ì—ì„œ ì—´ì–´ì„œ ë°”ë¡œ ì‚¬ë‹¤ë¦¬íƒ€ê¸°!" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://YOUR-SITE-URL.example" />
  <meta property="og:image" content="https://YOUR-SITE-URL.example/og.png" />

  <style>
    body { font-family: system-ui, -apple-system, sans-serif; margin: 18px; }
    h2 { margin: 10px 0 8px; font-size: 20px; }
    .row { display:flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    input, button, select { padding: 10px 12px; font-size: 14px; }
    button { cursor:pointer; border: 1px solid #ddd; border-radius: 10px; background: #fff; }
    button:active { transform: translateY(1px); }
    canvas { border: 1px solid #ddd; border-radius: 12px; width: 100%; height: auto; max-width: 720px; }
    .hint { color:#555; margin: 10px 0 6px; font-size: 13px; }
    .labels { display:flex; justify-content: space-between; max-width: 720px; }
    .labels div { width: calc(100%/6); text-align: center; font-weight: 600; font-size: 13px; }
    .bottom { margin-top: 6px; }
    .pill { display:inline-block; padding:3px 10px; border:1px solid #ddd; border-radius: 999px; margin-left: 4px; font-size: 12px; }
    .card { max-width: 760px; }
    .small { font-size: 12px; color: #666; margin-top: 10px; line-height: 1.5; }
    .warn { color:#b42318; }
  </style>

  <!-- âœ… ì¹´ì¹´ì˜¤ ê³µìœ  ë²„íŠ¼ì„ ì“°ë ¤ë©´ ì•„ë˜ SDKê°€ í•„ìš”í•©ë‹ˆë‹¤ (HTTPSë¡œ ë°°í¬ëœ í˜ì´ì§€ì—ì„œë§Œ ì •ìƒ ì‘ë™) -->
  <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.2/kakao.min.js"
          integrity="sha384-0XugQmT6QeQXr4m2P9Eo1QdO6jF6lKZ+gTz6H4gG9m0QyK7oV5pQj4Hc3mXk0u3I"
          crossorigin="anonymous"></script>
</head>
<body>
  <div class="card">
    <h2>ì‚¬ë‹¤ë¦¬íƒ€ê¸° (6ëª… / 1ëª… ë‹¹ì²¨)</h2>

    <div class="row">
      <button id="regen">ì‚¬ë‹¤ë¦¬ ë‹¤ì‹œ ë§Œë“¤ê¸°</button>

      <label>
        ì¶œë°œ ì„ íƒ:
        <select id="start">
          <option value="0">1ë²ˆ</option>
          <option value="1">2ë²ˆ</option>
          <option value="2">3ë²ˆ</option>
          <option value="3">4ë²ˆ</option>
          <option value="4">5ë²ˆ</option>
          <option value="5">6ë²ˆ</option>
        </select>
      </label>

      <button id="go">ë‚´ë ¤ê°€ê¸°(ê²°ê³¼ ë³´ê¸°)</button>
      <span id="result" class="pill">ê²°ê³¼: -</span>

      <button id="share">ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ê³µìœ </button>
    </div>

    <p class="hint">
      ê·œì¹™: ìœ„ì—ì„œ ì‹œì‘í•´ì„œ ì•„ë˜ë¡œ ë‚´ë ¤ê°€ë‹¤ê°€ ê°€ë¡œì¤„ì„ ë§Œë‚˜ë©´ ì˜†ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.
    </p>

    <div class="labels" id="topLabels"></div>
    <canvas id="c" width="720" height="520"></canvas>
    <div class="labels bottom" id="bottomLabels"></div>

    <div class="small">
      âœ… <b>ì¹´ì¹´ì˜¤í†¡ì—ì„œ â€œì‹¤í–‰â€</b>í•˜ë ¤ë©´, ì´ íŒŒì¼ì„ <b>ì˜¨ë¼ì¸(HTTPS)</b>ì— ì˜¬ë¦° ë’¤ ê·¸ <b>ë§í¬ë¥¼ ì¹´í†¡ìœ¼ë¡œ ê³µìœ </b>í•´ì•¼ í•´ìš”.<br/>
      <span class="warn">â€» ì¹´ì¹´ì˜¤í†¡ì€ PCì— ìˆëŠ” .html íŒŒì¼ì„ ì§ì ‘ ì‹¤í–‰í•  ìˆ˜ ì—†ì–´ìš”.</span><br/>
      ë¹ ë¥¸ ë°°í¬: Netlify Drop / GitHub Pages ì¶”ì²œ (ë‘˜ ë‹¤ ë¬´ë£Œ)
    </div>
  </div>

<script>
(() => {
  // =========================
  // 1) ì‚¬ë‹¤ë¦¬ ë¡œì§/ê·¸ë¦¬ê¸°
  // =========================
  const N = 6;
  const ROWS = 10;
  const P = 60;
  const TOP = 40;
  const H = 420;
  const W = 720;
  const stepY = H / (ROWS - 1);
  const stepX = (W - 2*P) / (N - 1);

  const canvas = document.getElementById("c");
  const ctx = canvas.getContext("2d");
  const regenBtn = document.getElementById("regen");
  const goBtn = document.getElementById("go");
  const shareBtn = document.getElementById("share");
  const startSel = document.getElementById("start");
  const resultEl = document.getElementById("result");
  const topLabels = document.getElementById("topLabels");
  const bottomLabels = document.getElementById("bottomLabels");

  const players = ["1ë²ˆ","2ë²ˆ","3ë²ˆ","4ë²ˆ","5ë²ˆ","6ë²ˆ"];
  function renderLabels() {
    topLabels.innerHTML = "";
    bottomLabels.innerHTML = "";
    players.forEach(t => {
      const d1 = document.createElement("div"); d1.textContent = t;
      const d2 = document.createElement("div"); d2.textContent = "-";
      topLabels.appendChild(d1); bottomLabels.appendChild(d2);
    });
  }
  renderLabels();

  let links = [];
  let winnerIndex = 5;

  function rndInt(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }

  function generateLadder() {
    winnerIndex = rndInt(0, N-1);
    links = Array.from({length: ROWS}, () => new Set());

    for (let r=0; r<ROWS; r++) {
      for (let i=0; i<N-1; i++) {
        const leftTaken = links[r].has(i-1);
        const hereTaken = links[r].has(i);
        if (leftTaken || hereTaken) continue;
        if (Math.random() < 0.35) links[r].add(i);
      }
    }

    draw();
    resultEl.textContent = "ê²°ê³¼: -";
  }

  function xOf(i){ return P + i*stepX; }
  function yOf(r){ return TOP + r*stepY; }

  function draw(pathPoints=[]) {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    ctx.lineWidth = 3;
    ctx.strokeStyle = "#333";
    for (let i=0; i<N; i++) {
      ctx.beginPath();
      ctx.moveTo(xOf(i), yOf(0));
      ctx.lineTo(xOf(i), yOf(ROWS-1));
      ctx.stroke();
    }

    ctx.lineWidth = 5;
    ctx.strokeStyle = "#111";
    for (let r=0; r<ROWS; r++) {
      links[r].forEach(i => {
        ctx.beginPath();
        ctx.moveTo(xOf(i), yOf(r));
        ctx.lineTo(xOf(i+1), yOf(r));
        ctx.stroke();
      });
    }

    [...bottomLabels.children].forEach((el, i) => {
      el.textContent = (i === winnerIndex) ? "ğŸ‰ë‹¹ì²¨" : "ê½";
    });

    if (pathPoints.length) {
      ctx.lineWidth = 6;
      ctx.strokeStyle = "#e11";
      ctx.beginPath();
      ctx.moveTo(pathPoints[0].x, pathPoints[0].y);
      for (const p of pathPoints) ctx.lineTo(p.x, p.y);
      ctx.stroke();
    }
  }

  function trace(startIdx) {
    let col = startIdx;
    const pts = [{x:xOf(col), y:yOf(0)}];

    for (let r=0; r<ROWS; r++) {
      if (links[r].has(col)) {
        pts.push({x:xOf(col), y:yOf(r)});
        pts.push({x:xOf(col+1), y:yOf(r)});
        col = col + 1;
      } else if (links[r].has(col-1)) {
        pts.push({x:xOf(col), y:yOf(r)});
        pts.push({x:xOf(col-1), y:yOf(r)});
        col = col - 1;
      }
      pts.push({x:xOf(col), y:yOf(r+1 < ROWS ? r+1 : r)});
    }
    return { end: col, points: pts };
  }

  function animatePath(points) {
    let i = 1;
    function step() {
      draw(points.slice(0, i));
      i++;
      if (i <= points.length) requestAnimationFrame(step);
    }
    step();
  }

  regenBtn.addEventListener("click", generateLadder);

  goBtn.addEventListener("click", () => {
    const startIdx = Number(startSel.value);
    const { end, points } = trace(startIdx);
    animatePath(points);
    const win = (end === winnerIndex);
    resultEl.textContent = `ê²°ê³¼: ${win ? "ğŸ‰ë‹¹ì²¨!" : "ê½"} (ë„ì°©: ${end+1}ë²ˆ)`;
  });

  generateLadder();

  // =========================
  // 2) ì¹´ì¹´ì˜¤í†¡ ê³µìœ  (ë§í¬ ê³µìœ )
  // =========================
  // âš ï¸ ê¼­ í•´ì•¼ í•˜ëŠ” ê²ƒ:
  // - ì¹´ì¹´ì˜¤ ë””ë²¨ë¡œí¼ìŠ¤ì—ì„œ JS í‚¤ ë°œê¸‰
  // - ë°œê¸‰ë°›ì€ í‚¤ë¡œ ì•„ë˜ ì´ˆê¸°í™”
  // - ë°°í¬í•œ ë„ë©”ì¸ì„ 'í”Œë«í¼ > Web'ì— ë“±ë¡
  const KAKAO_JS_KEY = "YOUR_KAKAO_JAVASCRIPT_KEY"; // â† ì—¬ê¸°ì— ë³¸ì¸ í‚¤ ë„£ê¸°
  const shareUrl = window.location.href;            // ë°°í¬ëœ í˜ì´ì§€ ì£¼ì†Œ(HTTPS)

  function initKakao() {
    if (!window.Kakao) return false;
    if (!Kakao.isInitialized()) {
      try {
        Kakao.init(KAKAO_JS_KEY);
      } catch (e) {
        return false;
      }
    }
    return true;
  }

  shareBtn.addEventListener("click", () => {
    // í‚¤ë¥¼ ì•„ì§ ì•ˆ ë„£ì—ˆë‹¤ë©´, ì¼ë‹¨ ì¼ë°˜ "ë§í¬ ë³µì‚¬"ë¡œ ëŒ€ì²´
    if (KAKAO_JS_KEY.includes("YOUR_")) {
      navigator.clipboard?.writeText(shareUrl).then(() => {
        alert("ì¹´ì¹´ì˜¤ í‚¤ê°€ ì•„ì§ ì—†ì–´ì„œ ë§í¬ë§Œ ë³µì‚¬í–ˆì–´ìš”!\nì¹´í†¡ì— ë¶™ì—¬ë„£ê¸° í•˜ë©´ ì—´ ìˆ˜ ìˆì–´ìš”.\n\n(ì¹´ì¹´ì˜¤ ê³µìœ  ë²„íŠ¼ì„ ì“°ë ¤ë©´ JS í‚¤ë¥¼ ë„£ì–´ì•¼ í•´ìš”.)");
      }).catch(() => {
        prompt("ì´ ë§í¬ë¥¼ ë³µì‚¬í•´ì„œ ì¹´í†¡ì— ë¶™ì—¬ë„£ê¸° í•´ì¤˜:", shareUrl);
      });
      return;
    }

    if (!initKakao()) {
      prompt("ì¹´ì¹´ì˜¤ SDK ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆì–´ìš”. ì¼ë‹¨ ë§í¬ë¥¼ ê³µìœ í•´ì¤˜:", shareUrl);
      return;
    }

    Kakao.Share.sendDefault({
      objectType: "feed",
      content: {
        title: "ì‚¬ë‹¤ë¦¬íƒ€ê¸° (6ëª…/1ëª… ë‹¹ì²¨)",
        description: "ì¹´í†¡ì—ì„œ ì—´ì–´ì„œ ë°”ë¡œ ì‚¬ë‹¤ë¦¬íƒ€ê¸°!",
        imageUrl: "https://YOUR-SITE-URL.example/og.png", // ë°°í¬ í›„ ì‹¤ì œ ì´ë¯¸ì§€ URLë¡œ êµì²´
        link: { mobileWebUrl: shareUrl, webUrl: shareUrl }
      },
      buttons: [
        { title: "ê²Œì„ ì—´ê¸°", link: { mobileWebUrl: shareUrl, webUrl: shareUrl } }
      ]
    });
  });
})();
</script>
</body>
</html>
